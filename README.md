# Snake Game with NCurses

C++과 NCurses 라이브러리를 사용하여 구현한 Snake Game입니다.

## 게임 특징

### 기본 게임 요소
- **Snake**: 방향키로 조작하는 뱀
- **Growth Item (+)**: 뱀의 길이를 1 증가시키는 아이템
- **Poison Item (-)**: 뱀의 길이를 1 감소시키는 아이템 (길이가 3 미만이 되면 게임 오버)
- **Gate**: 텔레포트 기능을 제공하는 게이트 (항상 쌍으로 등장)
  - **외부벽 Gate**: 맵 경계에 위치한 Gate는 고정된 방향으로 진출 (상단→아래, 하단→위, 좌측→오른쪽, 우측→왼쪽)
  - **내부벽 Gate**: 맵 내부에 위치한 Gate는 진입 방향에 따른 우선순위로 진출 방향 결정
  - **진입 중 보호**: Snake가 Gate에 진입 중일 때는 Gate가 만료되지 않고 새로운 Gate도 생성되지 않음
- **Wall**: 충돌 시 게임 오버가 되는 벽
- **Immune Wall**: 게이트로 변환되지 않는 특수 벽 (외부 경계)

### 맵 크기 및 구조
- **맵 크기**: 31x31 (기존 21x21에서 확대)
- **외부벽**: 31x31 맵의 경계를 둘러싸는 Immune Wall
- **내부벽**: 각 스테이지별로 간소화된 구조

### 스테이지 시스템
게임은 4개의 스테이지로 구성되며, 각 스테이지마다 다른 맵 레이아웃과 미션이 있습니다:

#### 스테이지 1: Basic Stage
- **맵**: 빈 맵 (내부벽 없음)
- **미션**: Growth Item 1개 획득

#### 스테이지 2: Cross Stage  
- **맵**: 간단한 십자가 모양의 내부벽
- **미션**: Growth Item 1개 획득 + Gate 1번 통과

#### 스테이지 3: L-Shape Stage
- **맵**: 간단한 L자 모양의 내부벽
- **미션**: Growth Item 1개 획득 + Gate 1번 통과

#### 스테이지 4: Box Stage
- **맵**: 간단한 사각형 구조의 내부벽 (중앙에 작은 구멍)
- **미션**: Growth Item 1개 획득 + Gate 1번 통과

### 미션 시스템
- 각 스테이지의 모든 미션을 완료하면 자동으로 다음 스테이지로 이동
- 스테이지 전환 시 뱀의 크기와 위치가 초기화됨 (길이 3, 안전한 위치에 배치)
- **스테이지별 카운터 초기화**: 스테이지 전환 시 Growth Item 획득 횟수와 Gate 사용 횟수가 0으로 초기화됨
- 실시간으로 현재 스테이지 정보와 미션 진행도가 화면에 표시됨
- 모든 스테이지를 완료하면 게임 클리어

### UI 및 표시
- **점수판 위치**: 31x31 맵 오른쪽에 점수판과 미션 정보 표시 (맵과 겹치지 않음)
- **실시간 정보 표시**: 
  - B: 현재 길이/최대 길이
  - +: Growth Item 수집 수 (스테이지별)
  - -: Poison Item 수집 수 (전체 누적)
  - G: Gate 사용 수 (스테이지별)
  - Score: 총 점수
- **스테이지 정보**: 현재 스테이지 번호, 이름, 미션 진행도
- **게임 완료**: 모든 스테이지 클리어 시 "CONGRATULATIONS!" 메시지 표시

### 게임 조작법
- **방향키**: 뱀의 이동 방향 변경
- **q**: 게임 종료
- **게임 목표**: 각 스테이지의 미션을 완료하여 다음 스테이지로 진행

### 게임 규칙
- 뱀은 자신의 몸이나 벽에 충돌하면 게임 오버
- 반대 방향으로 이동하려고 하면 즉시 게임 오버
- 아이템은 최대 3개까지 맵에 동시 존재
- 게이트는 한 번에 1쌍만 존재
- 스테이지 클리어 시 뱀이 초기 상태로 리셋됨

### Gate 진입 로직 (새로운 기능)
#### 외부벽 Gate 진출 방향 (고정)
- **상단 벽 Gate**: 항상 아래 방향으로 진출
- **하단 벽 Gate**: 항상 위 방향으로 진출
- **좌측 벽 Gate**: 항상 오른쪽 방향으로 진출
- **우측 벽 Gate**: 항상 왼쪽 방향으로 진출

#### 내부벽 Gate 진출 방향 우선순위
1. **진입 방향과 일치하는 방향** (최우선)
2. **진입 방향의 시계방향 회전**
3. **진입 방향의 역시계방향 회전**
4. **진입 방향과 반대 방향** (최후순위)

#### Gate 진입 상태 관리
- Snake가 Gate에 진입 중일 때는 해당 Gate가 만료되지 않음
- 진입 중일 때는 새로운 Gate 쌍이 생성되지 않음
- 텔레포트 완료 후 진입 상태가 자동으로 해제됨

## 빌드 및 실행

### 필요 조건
- C++17 이상
- NCurses 라이브러리
- CMake 3.10 이상

### 빌드 방법
```bash
mkdir build
cd build
cmake ..
make
```

### 실행 방법
```bash
./snake_game_v2
```

### 테스트 실행
```bash
# 모든 테스트 실행
make test

# 개별 테스트 실행
./game_test
./snake_test
./game_map_test
./stage_manager_test
# ... 기타 테스트들
```

## 프로젝트 구조

```
├── Game.hpp/cpp              # 메인 게임 로직
├── Snake.hpp/cpp             # 뱀 클래스
├── GameMap.hpp/cpp           # 게임 맵 관리
├── Item.hpp/cpp              # 아이템 클래스
├── ItemManager.hpp/cpp       # 아이템 관리자
├── Gate.hpp/cpp              # 게이트 클래스
├── GateManager.hpp/cpp       # 게이트 관리자
├── ScoreManager.hpp/cpp      # 점수 관리자
├── ColorManager.hpp/cpp      # 색상 관리자
├── Mission.hpp/cpp           # 미션 클래스
├── MissionManager.hpp/cpp    # 미션 관리자 (사용 안 함)
├── Stage.hpp/cpp             # 스테이지 클래스
├── StageManager.hpp/cpp      # 스테이지 관리자
├── main_game.cpp             # 메인 실행 파일
└── *Test.cpp                 # 각종 테스트 파일들
```

## 개발 방식
- **TDD (Test-Driven Development)**: 모든 주요 기능에 대해 테스트 코드 작성
- **단위 테스트**: Google Test 프레임워크 사용
- **모듈화**: 각 기능별로 클래스 분리하여 유지보수성 향상